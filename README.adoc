= JUG Registration App
:icons: font

https://quarkus.io[Quarkus] based application.

== Usage / Integration Configuration

Should be embedded in an `<iframe>` on the page.

Root page is `/registration?eventId=...`.

=== Query Params

|===
|Param name |default |Note

|eventId
|-
|The eventId as `yyyy-mm-dd` (date in ISO format). Required.

|limit
|60
|Participant limit

|showPub
|false
|If `true`, the checkbox for pub participation will be shown, otherwise not.

|deadline
|Date of eventId, 18:00:00+02:00
|ISO timestamp. Registration closes after given deadline.

|===


== Development

=== Prerequisites

* JDK 11+
* IDE
* Maven 3.6.2+
[[local-environment]]
* Optional (for local development):
** https://github.com/localstack/localstack[localstack]
** https://github.com/localstack/awscli-local[awscli-local]

=== Development with localstack

https://github.com/localstack/localstack[localstack] enables local development without any AWS cloud access.

* Install software for <<local-environment,local AWS development>>
* Run localstack with `localstack start` (this opens a serverless stack at http://localstack:4566, containing DynamoDB, Lambda, SES and other services known from the AWS cloud)
* Prepare local AWS stack
** Create DynamoDB tables: `awslocal dynamodb create-table --cli-input-json file://src/test/resources/dynamo-schema.json`
** Create test data bucket in s3: `awslocal s3api create-bucket --bucket test`
** Upload test events to s3: `awslocal s3 cp src/test/resources/s3/events.json s3://test`
** Upload test event data to s3: `awslocal s3 cp src/test/resources/s3/eventData.json s3://test`
* (Optional) Build application: `mvn clean package`
* Run application with `dev` profile:
** With Maven, use https://quarkus.io/guides/maven-tooling#development-mode[Quarkus Development Mode]: `mvn compile quarkus:dev`
+
TIP: You can now change classes, configurations and other resources on the fly and Quarkus will automatically reload on the next call.
** In IntelliJ start via run configuration:
+
image::src/main/asciidoctor/images/intellij-run-configuration-dev.png[]
+
TIP: This makes it even possible to run the application in debug mode.
** TBD: How to start the application via CLI (`java -jar ...`)?

* Run HTTP requests to test registration
+
[source]
----
include::registration-requests.http[]
----
<1> Show the current number of registrations and the HTML form to register
<2> Register participant for an event
<3> Upload additional webinar data to event
<4> Send e-mail message to participants
<5> Show overview of events
<6> Event administration UI (send mail, upload Webinar data)
<7> Show Webinar data
<8> Delete registration by unique key (_Caution_: This request is incomplete, you need to add the unique id you received on registration)
<9> Delete registration of participant by eventId and e-mail address
<10> Delete registration by eventId and unique key (_Caution_: This request is incomplete, you need to add the unique id you received on registration)

NOTE: Find/change the variables in link:http-client.env.json[].

== Build

Native, Docker will be used.

 $ mvn clean package -Pnative

== Deployment

https://www.serverless.com/[Serverless Framework 2.x+]

=== JUG DA

 $ sls deploy --tenant jugda

=== Cyberland

 $ sls deploy --tenant cyberland
